<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fütterung dokumentieren v1.4</title>

<style>
body{font-family:Arial;margin:1rem;font-size:20px}
h1{font-size:28px}
table, td, th{border:1px solid #ccc;border-collapse:collapse;padding:.5rem;font-size:22px}
input, select, button{font-size:22px;padding:.5rem;width:100%;max-width:200px}
.alert{font-size:26px;color:green;opacity:0;transition:opacity .3s;margin-top:.5rem}
.timer{font-size:34px;font-weight:bold;margin-top:1rem}
.stat{font-size:24px;margin-top:1rem}
.red{color:red;font-weight:bold}
.green{color:green;font-weight:bold}
#saveBtn{background-color:#4CAF50;color:white;border:none;cursor:pointer;margin-top:0.5rem}
#saveBtn:hover{background-color:#45a049}
.overview{display:flex;justify-content:space-between;margin-bottom:1rem;font-size:22px}
</style>
</head>
<body>

<h1>Fütterung dokumentieren v1.4</h1>

<div class="overview">
 <div id="todayDate">Datum heute: </div>
 <div id="lastDate">Letzte Fütterung: </div>
</div>

<table>
<tr><td>Ration auswählen</td><td><select id="ration"></select></td></tr>
<tr><td>Anzahl Tiere</td><td><input id="anz" type="number"></td><td id="lastAnz">-</td></tr>
<tr><td>Korrekturfaktor (%)</td><td><input id="fak" type="number"></td><td id="lastFak">-</td></tr>
<tr><td colspan="3"><button id="saveBtn" onclick="speichern()">Fütterung dokumentieren</button></td></tr>
</table>

<div class="alert" id="msg">Dokumentiert</div>
<div class="timer" id="timer"></div>
<div class="stat" id="stat"></div>

<table>
<thead><tr><th>Komponente</th><th>kg</th></tr></thead>
<tbody id="tbl"></tbody>
</table>

<script>
const rationCSV="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ3X2pqe0ycs2bDCTIgJA-KyXbzR80hCPK0TPgM7C6fyUh_xflB_Ry2PVu2BD_lbzBSgv2YVrxFec-v/pub?gid=0&single=true&output=csv";
const tsCSV="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ3X2pqe0ycs2bDCTIgJA-KyXbzR80hCPK0TPgM7C6fyUh_xflB_Ry2PVu2BD_lbzBSgv2YVrxFec-v/pub?gid=267748514&single=true&output=csv";
const feedCSV="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ3X2pqe0ycs2bDCTIgJA-KyXbzR80hCPK0TPgM7C6fyUh_xflB_Ry2PVu2BD_lbzBSgv2YVrxFec-v/pub?gid=1853046882&single=true&output=csv";
const formURL="https://docs.google.com/forms/d/e/1FAIpQLSe3xysbA5uxgEGDRy_lJAF2ZEDofJavgEXTlrz1POBcwMY3yw/formResponse";
const ENTRY_R="entry.690290440";
const ENTRY_A="entry.1406564399";
const ENTRY_F="entry.373869795";

let R={},TS={},ration=document.getElementById("ration"),anz=document.getElementById("anz"),fak=document.getElementById("fak"),tbl=document.getElementById("tbl"),msg=document.getElementById("msg"),timer=document.getElementById("timer"),stat=document.getElementById("stat"),lastAnz=document.getElementById("lastAnz"),lastFak=document.getElementById("lastFak"),todayDate=document.getElementById("todayDate"),lastDate=document.getElementById("lastDate");

async function csv(url){const t=await fetch(url);return(await t.t
